<html>
  <head>
    <title>Courtbot</title>
    <style>
      .hide {
        display:none;
      }
      #log {
        overflow: auto;
      }
      .sent, .received {
        display: block;
        width: 50%;
        border-radius: .5em;
        padding: .5em;
        margin-top: .5em;
      }
      .received {
        background-color: #d0e4c5;
        float: right;
      }
      .received-stamp {
        font-size: .6em;
        float: right;
        display: block;
        width: 50%;
        color: #999;
        text-align: right;
      }
      .sent {
        background-color: #e4f0ff;
        float: left;
      }
      .sent-stamp {
        font-size: .6em;
        float: left;
        display: block;
        width: 50%;
        color: #999;
      }
      form {
        max-width: 640px;
      }
      textarea {
        width: 50%;
      }
    </style>
    <script>
      function addLogEntry(msg, className) {
        function _addEntry(msg, className) {
          let node = document.createElement('DIV');
          node.classList.add(className);
          node.textContent = msg;
          document.getElementById('log').appendChild(node);
        }
        _addEntry(msg, className);
        _addEntry(new Date().toLocaleTimeString(), className + '-stamp');
      }
      // log what was sent
      function sent() {
        addLogEntry(document.getElementById('message').value, 'sent');
      }
      // log what was received
      function received() {
        let iframe = document.getElementById('my_iframe');
        let innerDoc = iframe.contentDocument || iframe.contentWindow.document;
        let sms = innerDoc.getElementsByTagName('sms');
        if (sms.length > 0) {
          addLogEntry(sms[0].textContent, 'received');
        }
      }
    </script>
  </head>
  <body>
    <h1>Impersonate Twilio</h1>

    <form action="/sms" method="POST" target="my_iframe" onsubmit="sent()">
        Phone Number: <input name="From" value="9075551234" type="tel"/> <br>

        <div class="activity">
          <iframe id="my_iframe" name="my_iframe" src="" onload="received()" class="hide"></iframe>
          <div id="log"></div>
        </div>

        <textarea id="message" name="Body" placeholder="Your Message"></textarea> <br>
        <input type="submit" value="Send"/>
    </form>

  </body>
</html>
